{"version":3,"file":"main.0a9c1219e4de58d148ee.hot-update.js","mappings":"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","sources":["webpack://tablet-ui/./src/components/MemberCheck.jsx","webpack://tablet-ui/webpack/runtime/getFullHash"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { checkMembership } from '../services/api';\r\nimport axios from 'axios';\r\n\r\nexport default function MemberCheck() {\r\n  const [nom, setNom] = useState('');\r\n  const [prenom, setPrenom] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n  \r\n  // Préchargement des sons\r\n  const [buzzerSound] = useState(new Audio('/assets/buzzer.mp3'));\r\n  const [bellSound] = useState(new Audio('/assets/bell.mp3'));\r\n\r\n  // Vérification adhésion\r\n  const handleVerification = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!nom.trim() || !prenom.trim()) {\r\n      setError(\"Veuillez entrer un nom et prénom valides\");\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError('');\r\n    \r\n    try {\r\n      // Version simplifiée pour tester - enregistre toujours la présence\r\n      // et redirige vers la confirmation pour débloquer\r\n      try {\r\n        const result = await checkMembership(nom, prenom);\r\n        console.log(\"Résultat de vérification:\", result);\r\n        \r\n        if (result.success && result.isPaid) {\r\n          // Enregistrement de la présence\r\n          try {\r\n            await axios.post('http://localhost:4000/presences', {\r\n              type: 'adherent',\r\n              nom,\r\n              prenom,\r\n              membreId: result.membre?.id || result.membre?.membreId\r\n            });\r\n            console.log(\"Présence enregistrée avec succès\");\r\n          } catch (presenceError) {\r\n            console.error(\"Erreur d'enregistrement de présence:\", presenceError);\r\n            // On continue même en cas d'erreur\r\n          }\r\n          \r\n          // Redirection vers la page de confirmation\r\n          navigate('/confirmation');\r\n        } else {\r\n          // Jouer le son d'erreur\r\n          buzzerSound.currentTime = 0;\r\n          buzzerSound.play().catch(err => console.error(\"Erreur lecture audio:\", err));\r\n          \r\n          // Afficher le message d'erreur\r\n          setError(result.message || \"Erreur lors de la vérification de l'adhésion\");\r\n        }\r\n      } catch (mainError) {\r\n        console.error(\"Erreur principale:\", mainError);\r\n        throw mainError; // Propager l'erreur pour le bloc catch suivant\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Erreur de vérification:\", err);\r\n      \r\n      // Jouer le son d'erreur\r\n      buzzerSound.currentTime = 0;\r\n      buzzerSound.play().catch(err => console.error(\"Erreur lecture audio:\", err));\r\n      \r\n      setError(\"Erreur lors de la vérification. Vérifiez que le serveur backend est démarré.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Appel bénévole\r\n  const handleCallVolunteer = () => {\r\n    bellSound.currentTime = 0;\r\n    bellSound.play().catch(err => console.error(\"Erreur lecture audio:\", err));\r\n  };\r\n\r\n  return (\r\n    <div className=\"member-check\">\r\n      <h2>Vérification d'adhésion</h2>\r\n      <form onSubmit={handleVerification}>\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"nom\">Nom</label>\r\n          <input\r\n            id=\"nom\"\r\n            type=\"text\"\r\n            placeholder=\"Nom\"\r\n            value={nom}\r\n            onChange={(e) => setNom(e.target.value)}\r\n            disabled={loading}\r\n            required\r\n          />\r\n        </div>\r\n        \r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"prenom\">Prénom</label>\r\n          <input\r\n            id=\"prenom\"\r\n            type=\"text\"\r\n            placeholder=\"Prénom\"\r\n            value={prenom}\r\n            onChange={(e) => setPrenom(e.target.value)}\r\n            disabled={loading}\r\n            required\r\n          />\r\n        </div>\r\n        \r\n        <button \r\n          type=\"submit\" \r\n          disabled={loading}\r\n          className={loading ? 'loading-button' : ''}\r\n        >\r\n          {loading ? 'Vérification en cours...' : 'Vérifier'}\r\n        </button>\r\n        \r\n        {error && (\r\n          <div className=\"error-message\">\r\n            {error}\r\n          </div>\r\n        )}\r\n      </form>\r\n      \r\n      <div className=\"buttons-container\">\r\n        <button \r\n          onClick={() => navigate('/')}\r\n          className=\"back-button\"\r\n        >\r\n          Retour à l'accueil\r\n        </button>\r\n        <button \r\n          onClick={handleCallVolunteer}\r\n          className=\"call-button\"\r\n        >\r\n          Appeler un bénévole\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","__webpack_require__.h = () => (\"9c32bd4a4f2fd6795b3b\")"],"names":["React","useState","useNavigate","checkMembership","axios","jsx","_jsx","jsxs","_jsxs","MemberCheck","_s","nom","setNom","prenom","setPrenom","loading","setLoading","error","setError","navigate","buzzerSound","Audio","bellSound","handleVerification","e","preventDefault","trim","result","console","log","success","isPaid","post","type","membreId","membre","id","presenceError","currentTime","play","catch","err","message","mainError","handleCallVolunteer","className","children","onSubmit","htmlFor","placeholder","value","onChange","target","disabled","required","onClick","_c","$RefreshReg$"],"sourceRoot":""}